\documentclass[11pt]{article}

    \usepackage[breakable]{tcolorbox}
    \usepackage{parskip} % Stop auto-indenting (to mimic markdown behaviour)
    
    \usepackage{iftex}
    \ifPDFTeX
    	\usepackage[T1]{fontenc}
    	\usepackage{mathpazo}
    \else
    	\usepackage{fontspec}
    \fi

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % Maintain compatibility with old templates. Remove in nbconvert 6.0
    \let\Oldincludegraphics\includegraphics
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionFormat{nocaption}{}
    \captionsetup{format=nocaption,aboveskip=0pt,belowskip=0pt}

    \usepackage[Export]{adjustbox} % Used to constrain images to a maximum size
    \adjustboxset{max size={0.9\linewidth}{0.9\paperheight}}
    \usepackage{float}
    \floatplacement{figure}{H} % forces figures to be placed at the correct location
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range
    \makeatletter % fix for grffile with XeLaTeX
    \def\Gread@@xetex#1{%
      \IfFileExists{"\Gin@base".bb}%
      {\Gread@eps{\Gin@base.bb}}%
      {\Gread@@xetex@aux#1}%
    }
    \makeatother

    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    % The default LaTeX title has an obnoxious amount of whitespace. By default,
    % titling removes some of it. It also provides customization options.
    \usepackage{titling}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    \usepackage{mathrsfs}
    

    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}
    \definecolor{ansi-default-inverse-fg}{HTML}{FFFFFF}
    \definecolor{ansi-default-inverse-bg}{HTML}{000000}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatibility definitions
    \def\gt{>}
    \def\lt{<}
    \let\Oldtex\TeX
    \let\Oldlatex\LaTeX
    \renewcommand{\TeX}{\textrm{\Oldtex}}
    \renewcommand{\LaTeX}{\textrm{\Oldlatex}}
    % Document parameters
    % Document title
    \title{Análisis inicial de Redes usando protocolo ICMP}
    
    
    
    
    
% Pygments definitions
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % For linebreaks inside Verbatim environment from package fancyvrb. 
    \makeatletter
        \newbox\Wrappedcontinuationbox 
        \newbox\Wrappedvisiblespacebox 
        \newcommand*\Wrappedvisiblespace {\textcolor{red}{\textvisiblespace}} 
        \newcommand*\Wrappedcontinuationsymbol {\textcolor{red}{\llap{\tiny$\m@th\hookrightarrow$}}} 
        \newcommand*\Wrappedcontinuationindent {3ex } 
        \newcommand*\Wrappedafterbreak {\kern\Wrappedcontinuationindent\copy\Wrappedcontinuationbox} 
        % Take advantage of the already applied Pygments mark-up to insert 
        % potential linebreaks for TeX processing. 
        %        {, <, #, %, $, ' and ": go to next line. 
        %        _, }, ^, &, >, - and ~: stay at end of broken line. 
        % Use of \textquotesingle for straight quote. 
        \newcommand*\Wrappedbreaksatspecials {% 
            \def\PYGZus{\discretionary{\char`\_}{\Wrappedafterbreak}{\char`\_}}% 
            \def\PYGZob{\discretionary{}{\Wrappedafterbreak\char`\{}{\char`\{}}% 
            \def\PYGZcb{\discretionary{\char`\}}{\Wrappedafterbreak}{\char`\}}}% 
            \def\PYGZca{\discretionary{\char`\^}{\Wrappedafterbreak}{\char`\^}}% 
            \def\PYGZam{\discretionary{\char`\&}{\Wrappedafterbreak}{\char`\&}}% 
            \def\PYGZlt{\discretionary{}{\Wrappedafterbreak\char`\<}{\char`\<}}% 
            \def\PYGZgt{\discretionary{\char`\>}{\Wrappedafterbreak}{\char`\>}}% 
            \def\PYGZsh{\discretionary{}{\Wrappedafterbreak\char`\#}{\char`\#}}% 
            \def\PYGZpc{\discretionary{}{\Wrappedafterbreak\char`\%}{\char`\%}}% 
            \def\PYGZdl{\discretionary{}{\Wrappedafterbreak\char`\$}{\char`\$}}% 
            \def\PYGZhy{\discretionary{\char`\-}{\Wrappedafterbreak}{\char`\-}}% 
            \def\PYGZsq{\discretionary{}{\Wrappedafterbreak\textquotesingle}{\textquotesingle}}% 
            \def\PYGZdq{\discretionary{}{\Wrappedafterbreak\char`\"}{\char`\"}}% 
            \def\PYGZti{\discretionary{\char`\~}{\Wrappedafterbreak}{\char`\~}}% 
        } 
        % Some characters . , ; ? ! / are not pygmentized. 
        % This macro makes them "active" and they will insert potential linebreaks 
        \newcommand*\Wrappedbreaksatpunct {% 
            \lccode`\~`\.\lowercase{\def~}{\discretionary{\hbox{\char`\.}}{\Wrappedafterbreak}{\hbox{\char`\.}}}% 
            \lccode`\~`\,\lowercase{\def~}{\discretionary{\hbox{\char`\,}}{\Wrappedafterbreak}{\hbox{\char`\,}}}% 
            \lccode`\~`\;\lowercase{\def~}{\discretionary{\hbox{\char`\;}}{\Wrappedafterbreak}{\hbox{\char`\;}}}% 
            \lccode`\~`\:\lowercase{\def~}{\discretionary{\hbox{\char`\:}}{\Wrappedafterbreak}{\hbox{\char`\:}}}% 
            \lccode`\~`\?\lowercase{\def~}{\discretionary{\hbox{\char`\?}}{\Wrappedafterbreak}{\hbox{\char`\?}}}% 
            \lccode`\~`\!\lowercase{\def~}{\discretionary{\hbox{\char`\!}}{\Wrappedafterbreak}{\hbox{\char`\!}}}% 
            \lccode`\~`\/\lowercase{\def~}{\discretionary{\hbox{\char`\/}}{\Wrappedafterbreak}{\hbox{\char`\/}}}% 
            \catcode`\.\active
            \catcode`\,\active 
            \catcode`\;\active
            \catcode`\:\active
            \catcode`\?\active
            \catcode`\!\active
            \catcode`\/\active 
            \lccode`\~`\~ 	
        }
    \makeatother

    \let\OriginalVerbatim=\Verbatim
    \makeatletter
    \renewcommand{\Verbatim}[1][1]{%
        %\parskip\z@skip
        \sbox\Wrappedcontinuationbox {\Wrappedcontinuationsymbol}%
        \sbox\Wrappedvisiblespacebox {\FV@SetupFont\Wrappedvisiblespace}%
        \def\FancyVerbFormatLine ##1{\hsize\linewidth
            \vtop{\raggedright\hyphenpenalty\z@\exhyphenpenalty\z@
                \doublehyphendemerits\z@\finalhyphendemerits\z@
                \strut ##1\strut}%
        }%
        % If the linebreak is at a space, the latter will be displayed as visible
        % space at end of first line, and a continuation symbol starts next line.
        % Stretch/shrink are however usually zero for typewriter font.
        \def\FV@Space {%
            \nobreak\hskip\z@ plus\fontdimen3\font minus\fontdimen4\font
            \discretionary{\copy\Wrappedvisiblespacebox}{\Wrappedafterbreak}
            {\kern\fontdimen2\font}%
        }%
        
        % Allow breaks at special characters using \PYG... macros.
        \Wrappedbreaksatspecials
        % Breaks at punctuation characters . , ; ? ! and / need catcode=\active 	
        \OriginalVerbatim[#1,codes*=\Wrappedbreaksatpunct]%
    }
    \makeatother

    % Exact colors from NB
    \definecolor{incolor}{HTML}{303F9F}
    \definecolor{outcolor}{HTML}{D84315}
    \definecolor{cellborder}{HTML}{CFCFCF}
    \definecolor{cellbackground}{HTML}{F7F7F7}
    
    % prompt
    \makeatletter
    \newcommand{\boxspacing}{\kern\kvtcb@left@rule\kern\kvtcb@boxsep}
    \makeatother
    \newcommand{\prompt}[4]{
        \ttfamily\llap{{\color{#2}[#3]:\hspace{3pt}#4}}\vspace{-\baselineskip}
    }
    

    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

\begin{document}
    
    \maketitle
    
    

    
    \hypertarget{introducciuxf3n}{%
\section{Introducción}\label{introducciuxf3n}}

Se desea conocer los caminos más comunes que recorren los paquetes de
datos entre la casa ecuatoriana promedio y ciertos sitios web de alto
tráfico y uso común. Esta información, geolocalizada, permite una mejor
comprensión de cómo la información cruza grandes distancias a través de
la capa física del modelo de conexión actual. Como es claro, estos
paquetes tienen que atravesar una serie de canales físicos que los
llevan a su destino final, siendo los más notorios los cables submarinos
a través de los cuales se envía la mayor parte de información del mundo.
Por supuesto, este experimento sólo es tán válido como lo son la calidad
de sus datos, por lo cual su funcionalidad se ve, de cierta manera,
limitada.

Los datos que se usan en este experimento fueron recaudados en una etapa
previa del proyecto. Se recolectaron tres datos (idealmente, en tiempos
distintos del día) por participante del proyecto, con un total de 22
participantes. En total, se recolectaron 66 documentos por sitio web que
describieran el camino que se empleó para llegar desde sus domicilios
hasta las páginas correspondientes. A pesar de que los participantes
tienen situaciones de alojamiento y conexiones variadas, es también
importante aclarar que todos los estudiantes viven en Quito, se
encuentran entre los 20 y los 25 años, y todos son estudiantes a tiempo
completo de una universidad privada de Ecuador, por lo que los datos
pueden estar sujetos a situaciones similares. Sin embargo, la variación
general que existe entre los estudiantes es suficiente para, aunque sea
\emph{a grosso modo}, crear una imagen general del tráfico de internet
de Quito a los sitios web investigados.

\hypertarget{metodologuxeda}{%
\section{Metodología}\label{metodologuxeda}}

Para la implementación de este experimento, se trabajó en lenguaje
Python, haciendo uso de las bibliotecas ya disponibles para graficar las
redes creadas, además de determinar el camino más común y averiguar más
información de este. Se basó el código, además, en la implementación ya
existente de Daniel Riofrío, PhD, para graficar la red general de todos
los documentos de la investigación previa. Se continuó con los
siguientes pasos:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Se determinó los sitios web a analizar para el proyecto.
\end{enumerate}

\begin{itemize}
\tightlist
\item
  Las direcciones web a analizar son:

  \begin{itemize}
  \tightlist
  \item
    Google.com
  \item
    Facebook.com
  \end{itemize}
\item
  A pesar de que esta elección fue al azar, estos sitios son ideales ya
  que por su alto tráfico y posición pública, los paquetes suelen llegar
  de manera confiable y rápida
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  Se separaron los archivos de interés del repertorio de archivos
  disponibles
\end{enumerate}

\begin{itemize}
\tightlist
\item
  El repertorio cuenta con 66 archivos para 22 sitios web de uso
  cotidiano distintos
\item
  Para los ejemplos en el informe, se utiliza la separación de
  Google.com
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{2}
\tightlist
\item
  Se almacenó la información de cada una de las direcciones IP
  exploradas en estos caminos, además de las veces que cada conexión
  entre dos IP específicas fue utilizada, en una estructura de grafo
\end{enumerate}

\begin{itemize}
\tightlist
\item
  Se filtran los datos que se consideran de una red LAN, y se los
  reemplaza con la dirección general ``127.0.0.1''
\item
  Se invierte los pesos del grafo, de tal manera que los caminos más
  transitados sean los más baratos
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{3}
\tightlist
\item
  Se encuentra la ruta más usada entre el punto de inicio y el punto de
  llegada
\end{enumerate}

\begin{itemize}
\tightlist
\item
  Debido a que existen varios puntos de llegada, se analiza la ruta más
  usada a cada uno
\item
  Se grafica, además, las rutas más usadas de cada punto
\end{itemize}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{4}
\tightlist
\item
  Del punto de llegada más común, se analiza la información de cada nodo
\end{enumerate}

\begin{itemize}
\tightlist
\item
  Se analiza la información de ANS y la información de Geolocalización
\item
  En caso de que un IP sea privado, se informe de tal
\end{itemize}

Una vez obtenida toda esta información, se procede a analizar los
resultados del experimento.

    Se declaran los módulos a utilizar.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{1}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{networkx} \PY{k}{as} \PY{n+nn}{nx}
\PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
\PY{k+kn}{import} \PY{n+nn}{os}
\PY{k+kn}{import} \PY{n+nn}{ip2geotools}\PY{n+nn}{.}\PY{n+nn}{databases}\PY{n+nn}{.}\PY{n+nn}{noncommercial} \PY{k}{as} \PY{n+nn}{dbs}
\PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
\PY{k+kn}{import} \PY{n+nn}{descartes}
\PY{k+kn}{import} \PY{n+nn}{geopandas} \PY{k}{as} \PY{n+nn}{gpd}
\PY{k+kn}{from} \PY{n+nn}{shapely}\PY{n+nn}{.}\PY{n+nn}{geometry} \PY{k+kn}{import} \PY{n}{Point}\PY{p}{,} \PY{n}{Polygon}
\PY{k+kn}{from} \PY{n+nn}{ipwhois} \PY{k+kn}{import} \PY{n}{IPWhois}
\PY{k+kn}{from} \PY{n+nn}{pprint} \PY{k+kn}{import} \PY{n}{pprint}

\PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
\end{Verbatim}
\end{tcolorbox}

    Se declaran las variables y contenedores de datos iniciales.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{2}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{site\PYZus{}name} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Google}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{start\PYZus{}ip} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{127.0.0.1}\PY{l+s+s1}{\PYZsq{}}

\PY{c+c1}{\PYZsh{}Path de lectura de archivos generados con traceroute.py}
\PY{n}{path} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{./All}\PY{l+s+s1}{\PYZsq{}}

\PY{c+c1}{\PYZsh{}lista todos los archivos dentro de la carpeta definida en path}
\PY{n}{files} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{listdir}\PY{p}{(}\PY{n}{path}\PY{p}{)}

\PY{c+c1}{\PYZsh{}diccionario que guarda los edges y sus frecuencias/pesos de los caminos mas comunes.}
\PY{n}{edge\PYZus{}dict} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}

\PY{c+c1}{\PYZsh{}Grafo dirigido que tendra todas las rutas que siguieron los paquetes.}
\PY{n}{G} \PY{o}{=} \PY{n}{nx}\PY{o}{.}\PY{n}{DiGraph}\PY{p}{(}\PY{p}{)}

\PY{c+c1}{\PYZsh{}contado de ips filtradas}
\PY{n}{filtered\PYZus{}counter} \PY{o}{=} \PY{l+m+mi}{0}
\end{Verbatim}
\end{tcolorbox}

    Se leen los archivos dentro del directorio \texttt{\textbackslash{}All}.
Cada archivo está estructurado de la forma: * IP destino * 1 IP * 2 IP
\ldots{} * n IP/Sitio Destino

y se arma el diccionario de edges con todas las secuencias de IPs en los
archivos.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{3}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{}forloop usado para leer todos los archivos listados en el path.}
\PY{k}{for} \PY{n}{file\PYZus{}name} \PY{o+ow}{in} \PY{n}{files}\PY{p}{:}

    \PY{n}{file\PYZus{}name\PYZus{}pieces} \PY{o}{=} \PY{n}{file\PYZus{}name}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    
    \PY{c+c1}{\PYZsh{}Saltamos este archivo si no corresponde al IP estudiado}
    \PY{k}{if} \PY{n}{site\PYZus{}name} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{file\PYZus{}name\PYZus{}pieces}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{:} 
        \PY{k}{continue}
    
    \PY{n}{fd} \PY{o}{=}  \PY{n+nb}{open}\PY{p}{(}\PY{n}{path}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/}\PY{l+s+s1}{\PYZsq{}}\PY{o}{+}\PY{n}{file\PYZus{}name}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{file} \PY{o}{=} \PY{n}{fd}\PY{o}{.}\PY{n}{read}\PY{p}{(}\PY{p}{)}
    \PY{n}{file\PYZus{}split} \PY{o}{=} \PY{n}{file}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{len\PYZus{}file\PYZus{}split} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{file\PYZus{}split}\PY{p}{)}

    \PY{n}{destination} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}
    \PY{n}{prev} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}

    \PY{c+c1}{\PYZsh{}ips que vamos a filtrar de los tres primeros registros de cada archivo que vamos a analizar.}
    \PY{c+c1}{\PYZsh{}¿qué son estos ips?}
    \PY{n}{filter\PYZus{}ip} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{192.168.100.1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{192.168.10.1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{192.168.1.1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                 \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{10.0.2.2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{192.168.0.1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{172.21.140.1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{192.168.4.1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                 \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{192.168.0.254}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{192.168.10.1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{192.168.1.10}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}

    \PY{c+c1}{\PYZsh{}ip de destino que se encuentra en la primera linea del archivo generado por traceroute.py}
    \PY{n}{destination} \PY{o}{=} \PY{n}{file\PYZus{}split}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{rstrip}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

    \PY{c+c1}{\PYZsh{}forloop para iterar todas las entradas del archivo generado por traceroute.py desde el primer registro del tipo 1\PYZhy{}IP.}
    \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{len\PYZus{}file\PYZus{}split}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
        \PY{n}{split\PYZus{}line} \PY{o}{=} \PY{n}{file\PYZus{}split}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{curr} \PY{o}{=} \PY{n}{split\PYZus{}line}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{n}{curr} \PY{o}{=} \PY{n}{curr}\PY{o}{.}\PY{n}{rstrip}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

        \PY{c+c1}{\PYZsh{}filtrado de cualquier current ip que no sea una ip valida.}
        \PY{k}{if} \PY{n}{curr} \PY{o}{!=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{*}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}

            \PY{c+c1}{\PYZsh{}filtrado de aquellas ips en filter\PYZus{}ip que esten en las primeras tres lineas del archivo.}
            \PY{k}{if} \PY{p}{(}\PY{n}{i} \PY{o}{==} \PY{l+m+mi}{1} \PY{o+ow}{or} \PY{n}{i} \PY{o}{==} \PY{l+m+mi}{2} \PY{o+ow}{or} \PY{n}{i} \PY{o}{==} \PY{l+m+mi}{3}\PY{p}{)} \PY{o+ow}{and} \PY{p}{(}\PY{n}{curr} \PY{o+ow}{in} \PY{n}{filter\PYZus{}ip}\PY{p}{)}\PY{p}{:}
                \PY{n}{filtered\PYZus{}counter} \PY{o}{=} \PY{n}{filtered\PYZus{}counter} \PY{o}{+} \PY{l+m+mi}{1}
            \PY{k}{else}\PY{p}{:}
                \PY{c+c1}{\PYZsh{}agrega los edges al diccionario que llevan al destino}
                \PY{k}{if} \PY{n}{curr} \PY{o}{==} \PY{n}{destination} \PY{o+ow}{and} \PY{n}{prev} \PY{o}{!=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                    \PY{n}{edge} \PY{o}{=} \PY{p}{(}\PY{n}{prev}\PY{p}{,} \PY{n}{destination}\PY{o}{.}\PY{n}{rstrip}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n}{file\PYZus{}name\PYZus{}pieces}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
                    \PY{k}{if} \PY{n}{edge} \PY{o+ow}{in} \PY{n}{edge\PYZus{}dict}\PY{p}{:}
                        \PY{n}{edge\PYZus{}dict}\PY{p}{[}\PY{n}{edge}\PY{p}{]} \PY{o}{=} \PY{n}{edge\PYZus{}dict}\PY{p}{[}\PY{n}{edge}\PY{p}{]} \PY{o}{+} \PY{l+m+mi}{1}
                    \PY{k}{else}\PY{p}{:}
                        \PY{n}{edge\PYZus{}dict}\PY{p}{[}\PY{n}{edge}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{1}
                \PY{k}{else}\PY{p}{:}
                    \PY{c+c1}{\PYZsh{}agrega los edges de aquellos edges que no llevan a destino}
                    \PY{c+c1}{\PYZsh{}en el if / positivo \PYZhy{}\PYZgt{} agrega toda ip seguida de otra ip en el camino del traceroute.}
                    \PY{k}{if} \PY{n}{prev} \PY{o}{!=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                        \PY{n}{edge} \PY{o}{=} \PY{p}{(}\PY{n}{prev}\PY{p}{,} \PY{n}{curr}\PY{p}{)}
                        \PY{k}{if} \PY{n}{edge} \PY{o+ow}{in} \PY{n}{edge\PYZus{}dict}\PY{p}{:}
                            \PY{n}{edge\PYZus{}dict}\PY{p}{[}\PY{n}{edge}\PY{p}{]} \PY{o}{=} \PY{n}{edge\PYZus{}dict}\PY{p}{[}\PY{n}{edge}\PY{p}{]} \PY{o}{+} \PY{l+m+mi}{1}
                        \PY{k}{else}\PY{p}{:}
                            \PY{n}{edge\PYZus{}dict}\PY{p}{[}\PY{n}{edge}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{1}
                    \PY{k}{else}\PY{p}{:}
                        \PY{c+c1}{\PYZsh{}agrega el nodo especial que vamos a llamar 127.0.0.1 desde el cual vamos a buscar el camino mas corto.}
                        \PY{k}{if} \PY{n}{curr} \PY{o}{!=} \PY{n}{destination} \PY{o+ow}{and} \PY{n}{prev} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                            \PY{n}{edge} \PY{o}{=} \PY{p}{(}\PY{n}{start\PYZus{}ip}\PY{p}{,} \PY{n}{curr}\PY{p}{)}
                            \PY{k}{if} \PY{o+ow}{not} \PY{n}{edge} \PY{o+ow}{in} \PY{n}{edge\PYZus{}dict}\PY{p}{:}
                                \PY{n}{edge\PYZus{}dict}\PY{p}{[}\PY{n}{edge}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{0}
                    \PY{n}{prev} \PY{o}{=} \PY{n}{curr}

\PY{c+c1}{\PYZsh{} Código por Daniel Riofrío (2020)}
\end{Verbatim}
\end{tcolorbox}

    Se estructuran los edges de \texttt{edge\_dict} en un grafo \texttt{G}.
Luego, se grafica el grafo completo.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{4}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{}Se agregan todos los edges y nodos al grafo}
\PY{k}{for} \PY{n}{key}\PY{p}{,} \PY{n}{value} \PY{o+ow}{in} \PY{n}{edge\PYZus{}dict}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{:}
    \PY{k}{if} \PY{n}{value} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
        \PY{n}{G}\PY{o}{.}\PY{n}{add\PYZus{}edge}\PY{p}{(}\PY{n}{key}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{key}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{weight}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
    \PY{k}{else}\PY{p}{:}
        \PY{n}{G}\PY{o}{.}\PY{n}{add\PYZus{}edge}\PY{p}{(}\PY{n}{key}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{key}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{weight}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{1.0}\PY{o}{/}\PY{n+nb}{float}\PY{p}{(}\PY{n}{value}\PY{p}{)}\PY{p}{)}\PY{p}{)}

\PY{c+c1}{\PYZsh{}se imprime el total de nodos del grafo.}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Nodes of graph: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{G}\PY{o}{.}\PY{n}{nodes}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\PY{c+c1}{\PYZsh{}se imprime el total de edges del grafo.}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Edges of graph: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{G}\PY{o}{.}\PY{n}{edges}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\PY{c+c1}{\PYZsh{}se imprime el total de nodos filtrados.}
\PY{n+nb}{print} \PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Filtered IPs: }\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{filtered\PYZus{}counter}\PY{p}{)}\PY{p}{)}
\PY{c+c1}{\PYZsh{}se imprimen todos los nodos que estan conectados al nodo especial 127.0.0.1}
\PY{n+nb}{print} \PY{p}{(}\PY{n}{G}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{127.0.0.1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}

\PY{c+c1}{\PYZsh{}se dibuja el grafo.}
\PY{n}{nx}\PY{o}{.}\PY{n}{draw}\PY{p}{(}\PY{n}{G}\PY{p}{,} \PY{n}{with\PYZus{}labels}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\PY{c+c1}{\PYZsh{}nx.draw\PYZus{}circular(G, with\PYZus{}labels=True)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Código por Daniel Riofrío (2020)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Nodes of graph:
198
Edges of graph:
361
Filtered IPs: 65
\{'172.21.18.126': \{'weight': 0\}, '181.198.150.1': \{'weight': 0\}, '172.20.10.1':
\{'weight': 0\}, '192.168.86.1': \{'weight': 0\}, '200.63.218.101': \{'weight': 0\},
'100.98.8.1': \{'weight': 0\}, '181.198.130.1': \{'weight': 0\}, '74.125.202.106':
\{'weight': 0\}, '172.253.66.57': \{'weight': 0\}, '172.253.50.89': \{'weight': 0\},
'186.4.244.1': \{'weight': 0\}, '100.97.32.1': \{'weight': 0\}, '157.100.244.1':
\{'weight': 0\}, '10.0.0.1': \{'weight': 0\}, '186.46.4.225': \{'weight': 0\},
'186.46.4.173': \{'weight': 0\}, '186.101.152.1': \{'weight': 0\}, '186.4.145.1':
\{'weight': 0\}, '100.96.233.1': \{'weight': 0\}, '200.63.218.185': \{'weight': 0\},
'100.98.68.1': \{'weight': 0\}, '186.101.137.1': \{'weight': 0\}, '181.198.191.129':
\{'weight': 0\}, '186.46.4.226': \{'weight': 0\}, '186.46.4.174': \{'weight': 0\}\}
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Análisis inicial de Redes usando protocolo ICMP_files/Análisis inicial de Redes usando protocolo ICMP_8_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    Se identifican todos los nodos finales del grafo (todos los nodos que
terminan en \texttt{/Google})

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{5}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{endpoints} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}

\PY{k}{for} \PY{n}{e}\PY{p}{,} \PY{n}{w} \PY{o+ow}{in} \PY{n}{edge\PYZus{}dict}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{:}
    \PY{k}{if} \PY{n}{site\PYZus{}name} \PY{o+ow}{in} \PY{n}{e}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{:} 
        \PY{k}{try}\PY{p}{:}
            \PY{n}{endpoints}\PY{p}{[}\PY{n}{e}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{]} \PY{o}{+}\PY{o}{=} \PY{n}{w}
        \PY{k}{except}\PY{p}{:}
            \PY{n}{endpoints}\PY{p}{[}\PY{n}{e}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{]} \PY{o}{=} \PY{n}{w}
            
\PY{n}{most\PYZus{}used\PYZus{}endpoint} \PY{o}{=} \PY{n+nb}{max}\PY{p}{(}\PY{n}{endpoints}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{)}            

\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Existen }\PY{l+s+s2}{\PYZdq{}}\PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{endpoints}\PY{p}{)}\PY{p}{)} \PY{o}{+} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ IPs destino para }\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{n}{site\PYZus{}name} \PY{o}{+} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{El endpoint más usado es :}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{most\PYZus{}used\PYZus{}endpoint}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Existen 10 IPs destino para Google

El endpoint más usado es :
 ('172.217.8.68/Google', 4)
    \end{Verbatim}

    Se busca en todos los edges el nodo de inicio \texttt{127.0.0.1} y se
identifican todos los nodos que lo suceden. Se guardan estos IPs como
\texttt{startpoints}.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{6}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{startpoints} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{n}{\PYZus{}startpoints} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}

\PY{k}{for} \PY{n}{e}\PY{p}{,} \PY{n}{w} \PY{o+ow}{in} \PY{n}{edge\PYZus{}dict}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{:}
    \PY{k}{if} \PY{n}{start\PYZus{}ip} \PY{o+ow}{in} \PY{n}{e}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{:} 
        \PY{n}{startpoints}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{e}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}

\PY{k}{for} \PY{n}{sp} \PY{o+ow}{in} \PY{n}{startpoints}\PY{p}{:}
    \PY{k}{for} \PY{n}{e}\PY{p}{,} \PY{n}{w} \PY{o+ow}{in} \PY{n}{edge\PYZus{}dict}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{:}
        \PY{k}{if} \PY{n}{sp} \PY{o+ow}{in} \PY{n}{e}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{:}
            \PY{k}{if} \PY{n}{e}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{\PYZus{}startpoints}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{:}
                \PY{n}{\PYZus{}startpoints}\PY{p}{[}\PY{n}{e}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]} \PY{o}{=} \PY{n}{w}
            \PY{k}{else}\PY{p}{:}
                \PY{n}{\PYZus{}startpoints}\PY{p}{[}\PY{n}{e}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]} \PY{o}{+}\PY{o}{=} \PY{n}{w}
    
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Existen }\PY{l+s+s2}{\PYZdq{}}\PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{\PYZus{}startpoints}\PY{p}{)}\PY{p}{)} \PY{o}{+} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ IPs que suceden al IP de inicio: }\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{n}{start\PYZus{}ip} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{total} \PY{o}{=} \PY{l+m+mi}{0}
\PY{k}{for} \PY{n}{sp}\PY{p}{,} \PY{n}{w} \PY{o+ow}{in} \PY{n}{\PYZus{}startpoints}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{:}
    \PY{n}{total} \PY{o}{+}\PY{o}{=} \PY{n}{w}
    
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{str(total)\PYZcb{} Total pesos de edges que proceden del edge con IP inicial (}\PY{l+s+si}{\PYZob{}start\PYZus{}ip\PYZcb{}}\PY{l+s+s2}{).}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Este número es mayor al número de archivos de }\PY{l+s+si}{\PYZob{}site\PYZus{}name\PYZcb{}}\PY{l+s+s2}{ porque no todos estos edges (\PYZus{}startpoints) proceden del edge con IP inicial }\PY{l+s+si}{\PYZob{}start\PYZus{}ip\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Existen 25 IPs que suceden al IP de inicio: 127.0.0.1

117 Total pesos de edges que proceden del edge con IP inicial (127.0.0.1).

Este número es mayor al número de archivos de Google porque no todos estos edges
(\_startpoints) proceden del edge con IP inicial 127.0.0.1
    \end{Verbatim}

    \hypertarget{shortest-path}{%
\subsection{Shortest Path}\label{shortest-path}}

Para encontrar el camino más usado en el grafo usamos el algoritmo de
\texttt{shortest\_path} que viene con \texttt{networkx}. Este algoritmo
construye un camino de un nodo inicial a uno final siguiendo los edges
con menores pesos posibles. Cabe recordar que en el código anterior, al
crear el Grafo e insertar los edges, los pesos son inversamente
proporcionales a las veces que un edge fue atravesado. Esto permite
considerar la ruta que devuelve este algoritmo como el camino más usado
para llegar al nodo destino.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{7}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{shortest\PYZus{}paths} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{40}\PY{p}{,} \PY{l+m+mi}{120}\PY{p}{)}\PY{p}{)}
\PY{n}{j} \PY{o}{=} \PY{l+m+mi}{0}

\PY{c+c1}{\PYZsh{} Para cada endpoint se busca su camino más corto en el grafo y se grafica.}
\PY{k}{for} \PY{n}{ep}\PY{p}{,} \PY{n}{times\PYZus{}used} \PY{o+ow}{in} \PY{n}{endpoints}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{:}
    \PY{n}{j} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
    \PY{n}{sp} \PY{o}{=} \PY{n}{nx}\PY{o}{.}\PY{n}{algorithms}\PY{o}{.}\PY{n}{shortest\PYZus{}path}\PY{p}{(}\PY{n}{G}\PY{p}{,} \PY{n}{source}\PY{o}{=}\PY{n}{start\PYZus{}ip} \PY{p}{,} \PY{n}{target}\PY{o}{=}\PY{n}{ep}\PY{p}{,} \PY{n}{weight}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{weight}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{shortest\PYZus{}paths}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sp}\PY{p}{)}
    \PY{n}{sp\PYZus{}G} \PY{o}{=} \PY{n}{nx}\PY{o}{.}\PY{n}{DiGraph}\PY{p}{(}\PY{p}{)}

    \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{sp}\PY{p}{)}\PY{p}{)}\PY{p}{:}
        \PY{k}{try}\PY{p}{:}
            \PY{n}{sp\PYZus{}G}\PY{o}{.}\PY{n}{add\PYZus{}edge}\PY{p}{(}\PY{n}{sp}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,} \PY{n}{sp}\PY{p}{[}\PY{n}{i}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{weight}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
        \PY{k}{except}\PY{p}{:}
            
            \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{j}\PY{p}{)}
            
            \PY{c+c1}{\PYZsh{}se dibuja el grafo.}
            \PY{n}{nx}\PY{o}{.}\PY{n}{draw}\PY{p}{(}\PY{n}{sp\PYZus{}G}\PY{p}{,} \PY{n}{with\PYZus{}labels}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
            \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Endpoint:}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZob{}ep\PYZcb{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{Path length:}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{len(sp)\PYZcb{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{Times used:}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZob{}times\PYZus{}used\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
            
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
C:\textbackslash{}ProgramData\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-
packages\textbackslash{}matplotlib\textbackslash{}backends\textbackslash{}backend\_agg.py:211: RuntimeWarning: Glyph 9 missing
from current font.
  font.set\_text(s, 0.0, flags=flags)
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Análisis inicial de Redes usando protocolo ICMP_files/Análisis inicial de Redes usando protocolo ICMP_14_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{whois}{%
\subsection{WHOIS}\label{whois}}

Para obtener la información de cada nodo del camino más frecuente
(determinado por el ``shortest path'' del peso inverso y el nodo más
frecuentado), se utiliza la librería de Python IPWhois. Esta librería
permite crear un objeto con el IP de un sitio web, y realizar búsquedas
RDAP (recomendado) o WHOIS (descontinuado). Se vuelve a calcular el
shortest path del nodo más usado y se lo guarda en una lista. A
continuación, se procede a iterar sobre esta lista, que contiene
direcciones IP. Para cada nodo IP se crea un objeto IPWhois y se realiza
una búsqueda RDAP, la cual luego es guardada en un diccionario. Se
accede este diccionario para imprimir la información del ASN (anonnymous
naming system), el código del país al que pertence, la descripción si la
tiene, y la base de datos con la que se encuentra registrada. En caso de
que se reporte un error de privacidad, la dirección simplemente indica
que el nodo que se está intentando revisar es privado.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{8}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Informacion WHOIS de cada nodo del camino}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

\PY{n}{most\PYZus{}used\PYZus{}path} \PY{o}{=} \PY{n}{nx}\PY{o}{.}\PY{n}{algorithms}\PY{o}{.}\PY{n}{shortest\PYZus{}path}\PY{p}{(}\PY{n}{G}\PY{p}{,} \PY{n}{source}\PY{o}{=}\PY{n}{start\PYZus{}ip} \PY{p}{,} \PY{n}{target}\PY{o}{=}\PY{n+nb}{max}\PY{p}{(}\PY{n}{endpoints}\PY{p}{)}\PY{p}{,} \PY{n}{weight}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{weight}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{country\PYZus{}codes} \PY{o}{=} \PY{p}{[}\PY{p}{]}

\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{most\PYZus{}used\PYZus{}path}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
    \PY{n}{ip} \PY{o}{=} \PY{n}{most\PYZus{}used\PYZus{}path}\PY{p}{[}\PY{n}{i}\PY{p}{]}
    \PY{n+nb}{print}\PY{p}{(}\PY{n}{ip}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{k}{try}\PY{p}{:}
        \PY{n}{obj} \PY{o}{=} \PY{n}{IPWhois}\PY{p}{(}\PY{n}{ip}\PY{p}{)}
        \PY{n}{result} \PY{o}{=} \PY{n}{obj}\PY{o}{.}\PY{n}{lookup\PYZus{}rdap}\PY{p}{(}\PY{n}{asn\PYZus{}methods}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dns}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{whois}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{http}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}Save country codes for later plotting}
        \PY{n}{country\PYZus{}codes}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{result}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{asn\PYZus{}country\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{ASN: }\PY{l+s+si}{\PYZob{}result[\PYZsq{}asn\PYZsq{}]\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{CIDR: }\PY{l+s+si}{\PYZob{}result[\PYZsq{}asn\PYZus{}cidr\PYZsq{}]\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
              \PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{Codigo de pais: }\PY{l+s+si}{\PYZob{}result[\PYZsq{}asn\PYZus{}country\PYZus{}code\PYZsq{}]\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
              \PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{Descripcion: }\PY{l+s+si}{\PYZob{}result[\PYZsq{}asn\PYZus{}description\PYZsq{}]\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
              \PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{Registrado en: }\PY{l+s+si}{\PYZob{}result[\PYZsq{}asn\PYZus{}registry\PYZsq{}]\PYZcb{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{sep}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{k}{except}\PY{p}{:}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{INFORMACION PRIVADA}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

\PY{n}{ep} \PY{o}{=} \PY{n}{most\PYZus{}used\PYZus{}path}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
\PY{n}{ep\PYZus{}ip} \PY{o}{=} \PY{n}{ep}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{ep\PYZus{}ip}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{k}{try}\PY{p}{:}
    \PY{n}{obj} \PY{o}{=} \PY{n}{IPWhois}\PY{p}{(}\PY{n}{ep\PYZus{}ip}\PY{p}{)}
    \PY{n}{result} \PY{o}{=} \PY{n}{obj}\PY{o}{.}\PY{n}{lookup\PYZus{}rdap}\PY{p}{(}\PY{n}{asn\PYZus{}methods}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dns}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{whois}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{http}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{ASN: }\PY{l+s+si}{\PYZob{}result[\PYZsq{}asn\PYZsq{}]\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{CIDR: }\PY{l+s+si}{\PYZob{}result[\PYZsq{}asn\PYZus{}cidr\PYZsq{}]\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
              \PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{Codigo de pais: }\PY{l+s+si}{\PYZob{}result[\PYZsq{}asn\PYZus{}country\PYZus{}code\PYZsq{}]\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
              \PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{Descripcion: }\PY{l+s+si}{\PYZob{}result[\PYZsq{}asn\PYZus{}description\PYZsq{}]\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
              \PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{Registrado en: }\PY{l+s+si}{\PYZob{}result[\PYZsq{}asn\PYZus{}registry\PYZsq{}]\PYZcb{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{sep}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{k}{except}\PY{p}{:}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{INFORMACION PRIVADA}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Informacion WHOIS de cada nodo del camino

127.0.0.1

        INFORMACION PRIVADA

181.198.130.1

        ASN: 27947
        CIDR: 181.198.128.0/19
        Codigo de pais: EC
        Descripcion: Telconet S.A, EC
        Registrado en: lacnic

10.201.232.57

        INFORMACION PRIVADA

10.201.232.53

        INFORMACION PRIVADA

10.201.232.38

        INFORMACION PRIVADA

10.201.232.42

        INFORMACION PRIVADA

10.201.232.61

        INFORMACION PRIVADA

10.201.232.5

        INFORMACION PRIVADA

74.125.146.38

        ASN: 15169
        CIDR: 74.125.0.0/16
        Codigo de pais: US
        Descripcion: GOOGLE, US
        Registrado en: arin

108.170.253.1

        ASN: 15169
        CIDR: 108.170.192.0/18
        Codigo de pais: US
        Descripcion: GOOGLE, US
        Registrado en: arin

108.170.253.19

        ASN: 15169
        CIDR: 108.170.192.0/18
        Codigo de pais: US
        Descripcion: GOOGLE, US
        Registrado en: arin

172.217.8.68

        ASN: 15169
        CIDR: 172.217.8.0/24
        Codigo de pais: US
        Descripcion: GOOGLE, US
        Registrado en: arin

    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{9}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Chequea cuantos edges conectan al IP de Telconet S.A.}
\PY{n}{ips} \PY{o}{=} \PY{p}{[}\PY{p}{]}

\PY{k}{for} \PY{n}{edge}\PY{p}{,} \PY{n}{w} \PY{o+ow}{in} \PY{n}{edge\PYZus{}dict}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{:}
    \PY{k}{if} \PY{n}{edge}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{181.198.130.1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
        \PY{n}{ips}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{(}\PY{n}{edge}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{w}\PY{p}{)}\PY{p}{)}

\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Al menos }\PY{l+s+si}{\PYZob{}ips[0][1]\PYZcb{}}\PY{l+s+s2}{ archivos incluyen una salida desde el IP de Telconet S.A.: 181.198.130.1}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Al menos 6 archivos incluyen una salida desde el IP de Telconet S.A.:
181.198.130.1
    \end{Verbatim}

    \hypertarget{geolocalizaciuxf3n-y-mapeo}{%
\subsection{Geolocalización y mapeo}\label{geolocalizaciuxf3n-y-mapeo}}

Se utiliza la librería \texttt{ip2geotools} para consultar una base de
datos que contiene información de geolocalización de IPs públicas. La
base de datos usada es \texttt{HostIP} porque permite consultar de forma
gratuita y sin necesidad de API keys.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{10}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Se obtiene el camino más usado en el grafo}
\PY{n}{most\PYZus{}used\PYZus{}path} \PY{o}{=} \PY{n}{nx}\PY{o}{.}\PY{n}{algorithms}\PY{o}{.}\PY{n}{shortest\PYZus{}path}\PY{p}{(}\PY{n}{G}\PY{p}{,} \PY{n}{source}\PY{o}{=}\PY{n}{start\PYZus{}ip} \PY{p}{,} \PY{n}{target}\PY{o}{=}\PY{n+nb}{max}\PY{p}{(}\PY{n}{endpoints}\PY{p}{)}\PY{p}{,} \PY{n}{weight}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{weight}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{coordinates} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{n}{just\PYZus{}countries} \PY{o}{=} \PY{p}{[}\PY{p}{]}


\PY{k}{for} \PY{n}{ip} \PY{o+ow}{in} \PY{n}{most\PYZus{}used\PYZus{}path}\PY{p}{:}
    \PY{n}{ip} \PY{o}{=} \PY{n}{ip}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
    \PY{c+c1}{\PYZsh{} Se consulta la base de datos}
    \PY{n}{r} \PY{o}{=} \PY{n}{dbs}\PY{o}{.}\PY{n}{HostIP}\PY{o}{.}\PY{n}{get}\PY{p}{(}\PY{n}{ip}\PY{p}{)}
    
    \PY{c+c1}{\PYZsh{} Si no devuelve información, es una IP privada}
    \PY{k}{if} \PY{o+ow}{not} \PY{n}{r}\PY{o}{.}\PY{n}{country} \PY{o+ow}{and} \PY{o+ow}{not} \PY{n}{r}\PY{o}{.}\PY{n}{region} \PY{o+ow}{and} \PY{o+ow}{not} \PY{n}{r}\PY{o}{.}\PY{n}{city} \PY{o+ow}{and} \PY{o+ow}{not} \PY{n}{r}\PY{o}{.}\PY{n}{longitude} \PY{o+ow}{and} \PY{o+ow}{not} \PY{n}{r}\PY{o}{.}\PY{n}{latitude}\PY{p}{:}
        \PY{n+nb}{print}\PY{p}{(}\PY{n}{ip}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Private}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{sep}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{k}{else}\PY{p}{:}
        \PY{k}{if} \PY{n}{r}\PY{o}{.}\PY{n}{longitude} \PY{o+ow}{and} \PY{n}{r}\PY{o}{.}\PY{n}{latitude}\PY{p}{:} 
            \PY{n}{coordinates}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{(}\PY{n}{r}\PY{o}{.}\PY{n}{longitude}\PY{p}{,} \PY{n}{r}\PY{o}{.}\PY{n}{latitude}\PY{p}{)}\PY{p}{)}
        \PY{k}{elif} \PY{n}{r}\PY{o}{.}\PY{n}{country}\PY{p}{:} 
            \PY{n}{just\PYZus{}countries}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{r}\PY{o}{.}\PY{n}{country}\PY{p}{)}
            
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+si}{\PYZob{}ip\PYZcb{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{Ctry:}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{r.country if r.country else }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{\PYZcb{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{City:}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{r.city if r.city else }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{\PYZcb{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{Regn:}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{r.region if r.region else }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{\PYZcb{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{Long:}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{r.longitude if r.longitude else }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{\PYZcb{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{Lat:}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{r.latitude if r.latitude else }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{\PYZcb{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Se guardan todos los países que se conocen que atraviesa el camino.}
\PY{n}{just\PYZus{}countries}\PY{o}{.}\PY{n}{extend}\PY{p}{(}\PY{n+nb}{set}\PY{p}{(}\PY{n}{country\PYZus{}codes}\PY{p}{)}\PY{p}{)}              
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
127.0.0.1       Private
181.198.130.1   Private
10.201.232.57   Private
10.201.232.53   Private
10.201.232.38   Private
10.201.232.42   Private
10.201.232.61   Private
10.201.232.5    Private
74.125.146.38   Private
108.170.253.1   Private
108.170.253.19  Private
172.217.8.68    Private
    \end{Verbatim}

    Para graficar las coordenadas de los IPs se utiliza la librería
\texttt{geopandas} junto con un archivo \texttt{.shp} que contiene el
mapa a graficar. Se grafican dos colores de puntos: * Rojo: IP con
ubicación exacta conocida. * Gris: IP cuya única información es su país.

Para ubicar en el mapa los puntos grises se utiliza un archivo
\texttt{.csv} que contienen información de cada país y sus coordenadas
centrales respectivas. Estas coordenadas son usadas en el mapa.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{11}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Se genera el mapa del mundo}
\PY{n+nb}{map} \PY{o}{=} \PY{n}{gpd}\PY{o}{.}\PY{n}{read\PYZus{}file}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{TM\PYZus{}WORLD\PYZus{}BORDERS\PYZhy{}0.3.shp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Datos exactos}
\PY{n}{geometry} \PY{o}{=} \PY{p}{[}\PY{n}{Point}\PY{p}{(}\PY{n}{xy}\PY{p}{)} \PY{k}{for} \PY{n}{xy} \PY{o+ow}{in} \PY{n}{coordinates}\PY{p}{]}
\PY{n}{geo\PYZus{}df\PYZus{}exact} \PY{o}{=} \PY{n}{gpd}\PY{o}{.}\PY{n}{GeoDataFrame}\PY{p}{(}\PY{n}{geometry}\PY{o}{=} \PY{n}{geometry}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Se lee el .csv y se extraen los datos de coordenadas de países}
\PY{n}{country\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{countries\PYZus{}codes\PYZus{}and\PYZus{}coordinates.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{country\PYZus{}df} \PY{o}{=} \PY{n}{country\PYZus{}df}\PY{o}{.}\PY{n}{set\PYZus{}index}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{alpha\PYZhy{}2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{\PYZus{}df} \PY{o}{=} \PY{n}{country\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{just\PYZus{}countries}\PY{p}{]}
\PY{n}{just\PYZus{}c\PYZus{}coords} \PY{o}{=} \PY{p}{[}\PY{n}{xy} \PY{k}{for} \PY{n}{xy} \PY{o+ow}{in} \PY{n+nb}{zip}\PY{p}{(}\PY{p}{[}\PY{n}{x}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{longitude}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{n}{x}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{latitude}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{]}


\PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{)}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Plot de puntos rojos}
\PY{n+nb}{map}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{,} \PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{green}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{;}
\PY{n}{geo\PYZus{}df\PYZus{}exact}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{red}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{;}

\PY{c+c1}{\PYZsh{} Plot de puntos grises}
\PY{n}{geometry} \PY{o}{=} \PY{p}{[}\PY{n}{Point}\PY{p}{(}\PY{n}{xy}\PY{p}{)} \PY{k}{for} \PY{n}{xy} \PY{o+ow}{in} \PY{n}{just\PYZus{}c\PYZus{}coords}\PY{p}{]}
\PY{n}{geo\PYZus{}df\PYZus{}just\PYZus{}c} \PY{o}{=} \PY{n}{gpd}\PY{o}{.}\PY{n}{GeoDataFrame}\PY{p}{(}\PY{n}{geometry}\PY{o}{=} \PY{n}{geometry}\PY{p}{)}
\PY{n}{geo\PYZus{}df\PYZus{}just\PYZus{}c}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{;}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
C:\textbackslash{}ProgramData\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-packages\textbackslash{}geopandas\textbackslash{}plotting.py:510:
UserWarning: The GeoDataFrame you are attempting to plot is empty. Nothing has
been displayed.
  UserWarning,
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Análisis inicial de Redes usando protocolo ICMP_files/Análisis inicial de Redes usando protocolo ICMP_21_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{conclusiones}{%
\section{Conclusiones}\label{conclusiones}}

El análisis de rutas de IP fue complicado desde el inicio. El mayor
problema es obtener datos limpios, y desde la etapa de obtención de las
rutas para cada sitio web ya faltan datos porque la mayoría archivos no
muestran todos los IPs por los que pasaron los paquetes de datos. El
análisis del grafo se pudo realizar correctamente y se pudieron
encontrar las rutas más usadas omitiendo los IPs que no se hallaban en
los archivos. Por último, el análisis de IPs mediante Whois resultó más
informativo que la búsqueda de coordenadas globales con
\texttt{ip2geotools} porque es muy escasa la información gratis que se
puede obtener mediante este segundo método. Sin embargo, se pudo
unificar la data obtenida de ambos métodos y se pudo graficar en un mapa
tanto los IPs con coordenadas conocidas como los IPs cuya única
información es su país.

\begin{itemize}
\tightlist
\item
  ¿Por dónde pasan las comunicaciones que salen del país?

  \begin{itemize}
  \tightlist
  \item
    Mediante Whois se pudo ver que en la ruta más usada existe un nodo
    de Telconet S.A. tanto para Google.com como Facebook.com
  \end{itemize}
\item
  ¿Cuántas personas usan un mismo servicio de internet en clase?

  \begin{itemize}
  \tightlist
  \item
    Analizando solamente la ruta más utilizada, existen 6 edges que
    conectan desde Telconet S.A. O sea que al menos 2 y máximo 6
    estudiantes utilizan este servicio. Este caso es igual tanto para
    Google.com como Facebook.com
  \end{itemize}
\item
  ¿Es seguro que estemos haciendo este tipo de mediciones desde casa?

  \begin{itemize}
  \tightlist
  \item
    Seguridad: El nivel de seguridad de realizar las mediciones de
    traceroute es la misma que al ingresar a los sitios web mediante un
    navegador porque los paquetes enviados no contienen información más
    compremetedora que la que un navegador envía.
  \item
    Fiabilidad: La fiabilidad de los datos es cuestionable porque el
    filtro de IPs LAN no es perfecto, y en este proceso se pueden haber
    filtrado IPs que no corresponden a una red LAN, o al reves, se
    pueden haber no filtrado IPs LAN.
  \end{itemize}
\item
  ¿Qué pasa si corremos este tipo de monitoreo todos los días, todos los
  minutos?

  \begin{itemize}
  \tightlist
  \item
    Las rutas varían a cada hora y minuto del día. La cantidad de
    tráfico en la web define en parte las decisiones de enrutamiento de
    los paquetes.
  \end{itemize}
\end{itemize}

    \hypertarget{anexo-facebook.com}{%
\section{Anexo: Facebook.com}\label{anexo-facebook.com}}

Este código es idéntico en funcionalidad al corrido para Google.com

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{12}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{site\PYZus{}name} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Facebook}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{edge\PYZus{}dict} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
\PY{n}{G} \PY{o}{=} \PY{n}{nx}\PY{o}{.}\PY{n}{DiGraph}\PY{p}{(}\PY{p}{)}

\PY{c+c1}{\PYZsh{}contado de ips filtradas}
\PY{n}{filtered\PYZus{}counter} \PY{o}{=} \PY{l+m+mi}{0}

\PY{c+c1}{\PYZsh{}forloop usado para leer todos los archivos listados en el path.}
\PY{k}{for} \PY{n}{file\PYZus{}name} \PY{o+ow}{in} \PY{n}{files}\PY{p}{:}

    \PY{n}{file\PYZus{}name\PYZus{}pieces} \PY{o}{=} \PY{n}{file\PYZus{}name}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    
    \PY{c+c1}{\PYZsh{}Saltamos este archivo si no corresponde al IP estudiado}
    \PY{k}{if} \PY{n}{site\PYZus{}name} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{file\PYZus{}name\PYZus{}pieces}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{:} 
        \PY{k}{continue}
    
    \PY{n}{fd} \PY{o}{=}  \PY{n+nb}{open}\PY{p}{(}\PY{n}{path}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/}\PY{l+s+s1}{\PYZsq{}}\PY{o}{+}\PY{n}{file\PYZus{}name}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{file} \PY{o}{=} \PY{n}{fd}\PY{o}{.}\PY{n}{read}\PY{p}{(}\PY{p}{)}
    \PY{n}{file\PYZus{}split} \PY{o}{=} \PY{n}{file}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{len\PYZus{}file\PYZus{}split} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{file\PYZus{}split}\PY{p}{)}

    \PY{n}{destination} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}
    \PY{n}{prev} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}

    \PY{c+c1}{\PYZsh{}ips que vamos a filtrar de los tres primeros registros de cada archivo que vamos a analizar.}
    \PY{c+c1}{\PYZsh{}¿qué son estos ips?}
    \PY{n}{filter\PYZus{}ip} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{192.168.100.1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{192.168.10.1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{192.168.1.1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                 \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{10.0.2.2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{192.168.0.1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{172.21.140.1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{192.168.4.1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                 \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{192.168.0.254}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{192.168.10.1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{192.168.1.10}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}

    \PY{c+c1}{\PYZsh{}ip de destino que se encuentra en la primera linea del archivo generado por traceroute.py}
    \PY{n}{destination} \PY{o}{=} \PY{n}{file\PYZus{}split}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{rstrip}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

    \PY{c+c1}{\PYZsh{}forloop para iterar todas las entradas del archivo generado por traceroute.py desde el primer registro del tipo 1\PYZhy{}IP.}
    \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{len\PYZus{}file\PYZus{}split}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
        \PY{n}{split\PYZus{}line} \PY{o}{=} \PY{n}{file\PYZus{}split}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{curr} \PY{o}{=} \PY{n}{split\PYZus{}line}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{n}{curr} \PY{o}{=} \PY{n}{curr}\PY{o}{.}\PY{n}{rstrip}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

        \PY{c+c1}{\PYZsh{}filtrado de cualquier current ip que no sea una ip valida.}
        \PY{k}{if} \PY{n}{curr} \PY{o}{!=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{*}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}

            \PY{c+c1}{\PYZsh{}filtrado de aquellas ips en filter\PYZus{}ip que esten en las primeras tres lineas del archivo.}
            \PY{k}{if} \PY{p}{(}\PY{n}{i} \PY{o}{==} \PY{l+m+mi}{1} \PY{o+ow}{or} \PY{n}{i} \PY{o}{==} \PY{l+m+mi}{2} \PY{o+ow}{or} \PY{n}{i} \PY{o}{==} \PY{l+m+mi}{3}\PY{p}{)} \PY{o+ow}{and} \PY{p}{(}\PY{n}{curr} \PY{o+ow}{in} \PY{n}{filter\PYZus{}ip}\PY{p}{)}\PY{p}{:}
                \PY{n}{filtered\PYZus{}counter} \PY{o}{=} \PY{n}{filtered\PYZus{}counter} \PY{o}{+} \PY{l+m+mi}{1}
            \PY{k}{else}\PY{p}{:}
                \PY{c+c1}{\PYZsh{}agrega los edges al diccionario que llevan al destino}
                \PY{k}{if} \PY{n}{curr} \PY{o}{==} \PY{n}{destination} \PY{o+ow}{and} \PY{n}{prev} \PY{o}{!=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                    \PY{n}{edge} \PY{o}{=} \PY{p}{(}\PY{n}{prev}\PY{p}{,} \PY{n}{destination}\PY{o}{.}\PY{n}{rstrip}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n}{file\PYZus{}name\PYZus{}pieces}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
                    \PY{k}{if} \PY{n}{edge} \PY{o+ow}{in} \PY{n}{edge\PYZus{}dict}\PY{p}{:}
                        \PY{n}{edge\PYZus{}dict}\PY{p}{[}\PY{n}{edge}\PY{p}{]} \PY{o}{=} \PY{n}{edge\PYZus{}dict}\PY{p}{[}\PY{n}{edge}\PY{p}{]} \PY{o}{+} \PY{l+m+mi}{1}
                    \PY{k}{else}\PY{p}{:}
                        \PY{n}{edge\PYZus{}dict}\PY{p}{[}\PY{n}{edge}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{1}
                \PY{k}{else}\PY{p}{:}
                    \PY{c+c1}{\PYZsh{}agrega los edges de aquellos edges que no llevan a destino}
                    \PY{c+c1}{\PYZsh{}en el if / positivo \PYZhy{}\PYZgt{} agrega toda ip seguida de otra ip en el camino del traceroute.}
                    \PY{k}{if} \PY{n}{prev} \PY{o}{!=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                        \PY{n}{edge} \PY{o}{=} \PY{p}{(}\PY{n}{prev}\PY{p}{,} \PY{n}{curr}\PY{p}{)}
                        \PY{k}{if} \PY{n}{edge} \PY{o+ow}{in} \PY{n}{edge\PYZus{}dict}\PY{p}{:}
                            \PY{n}{edge\PYZus{}dict}\PY{p}{[}\PY{n}{edge}\PY{p}{]} \PY{o}{=} \PY{n}{edge\PYZus{}dict}\PY{p}{[}\PY{n}{edge}\PY{p}{]} \PY{o}{+} \PY{l+m+mi}{1}
                        \PY{k}{else}\PY{p}{:}
                            \PY{n}{edge\PYZus{}dict}\PY{p}{[}\PY{n}{edge}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{1}
                    \PY{k}{else}\PY{p}{:}
                        \PY{c+c1}{\PYZsh{}agrega el nodo especial que vamos a llamar 127.0.0.1 desde el cual vamos a buscar el camino mas corto.}
                        \PY{k}{if} \PY{n}{curr} \PY{o}{!=} \PY{n}{destination} \PY{o+ow}{and} \PY{n}{prev} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                            \PY{n}{edge} \PY{o}{=} \PY{p}{(}\PY{n}{start\PYZus{}ip}\PY{p}{,} \PY{n}{curr}\PY{p}{)}
                            \PY{k}{if} \PY{o+ow}{not} \PY{n}{edge} \PY{o+ow}{in} \PY{n}{edge\PYZus{}dict}\PY{p}{:}
                                \PY{n}{edge\PYZus{}dict}\PY{p}{[}\PY{n}{edge}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{0}
                    \PY{n}{prev} \PY{o}{=} \PY{n}{curr}

\PY{c+c1}{\PYZsh{} Código por Daniel Riofrío (2020)}

\PY{c+c1}{\PYZsh{}Se agregan todos los edges y nodos al grafo}
\PY{k}{for} \PY{n}{key}\PY{p}{,} \PY{n}{value} \PY{o+ow}{in} \PY{n}{edge\PYZus{}dict}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{:}
    \PY{k}{if} \PY{n}{value} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
        \PY{n}{G}\PY{o}{.}\PY{n}{add\PYZus{}edge}\PY{p}{(}\PY{n}{key}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{key}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{weight}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
    \PY{k}{else}\PY{p}{:}
        \PY{n}{G}\PY{o}{.}\PY{n}{add\PYZus{}edge}\PY{p}{(}\PY{n}{key}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{key}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{weight}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{1.0}\PY{o}{/}\PY{n+nb}{float}\PY{p}{(}\PY{n}{value}\PY{p}{)}\PY{p}{)}\PY{p}{)}

\PY{c+c1}{\PYZsh{}se imprime el total de nodos del grafo.}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Nodes of graph: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{G}\PY{o}{.}\PY{n}{nodes}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\PY{c+c1}{\PYZsh{}se imprime el total de edges del grafo.}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Edges of graph: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{G}\PY{o}{.}\PY{n}{edges}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\PY{c+c1}{\PYZsh{}se imprime el total de nodos filtrados.}
\PY{n+nb}{print} \PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Filtered IPs: }\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n}{filtered\PYZus{}counter}\PY{p}{)}\PY{p}{)}
\PY{c+c1}{\PYZsh{}se imprimen todos los nodos que estan conectados al nodo especial 127.0.0.1}
\PY{n+nb}{print} \PY{p}{(}\PY{n}{G}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{127.0.0.1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}

\PY{c+c1}{\PYZsh{}se dibuja el grafo.}
\PY{n}{nx}\PY{o}{.}\PY{n}{draw}\PY{p}{(}\PY{n}{G}\PY{p}{,} \PY{n}{with\PYZus{}labels}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\PY{c+c1}{\PYZsh{}nx.draw\PYZus{}circular(G, with\PYZus{}labels=True)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}

\PY{c+c1}{\PYZsh{} Código por Daniel Riofrío (2020)}

\PY{n}{endpoints} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}

\PY{k}{for} \PY{n}{e}\PY{p}{,} \PY{n}{w} \PY{o+ow}{in} \PY{n}{edge\PYZus{}dict}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{:}
    \PY{k}{if} \PY{n}{site\PYZus{}name} \PY{o+ow}{in} \PY{n}{e}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{:} 
        \PY{k}{try}\PY{p}{:}
            \PY{n}{endpoints}\PY{p}{[}\PY{n}{e}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{]} \PY{o}{+}\PY{o}{=} \PY{n}{w}
        \PY{k}{except}\PY{p}{:}
            \PY{n}{endpoints}\PY{p}{[}\PY{n}{e}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{]} \PY{o}{=} \PY{n}{w}
            
\PY{n}{most\PYZus{}used\PYZus{}endpoint} \PY{o}{=} \PY{n+nb}{max}\PY{p}{(}\PY{n}{endpoints}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{)}            

\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Existen }\PY{l+s+s2}{\PYZdq{}}\PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{endpoints}\PY{p}{)}\PY{p}{)} \PY{o}{+} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ IPs destino para }\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{n}{site\PYZus{}name} \PY{o}{+} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{El endpoint más usado es :}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{most\PYZus{}used\PYZus{}endpoint}\PY{p}{)}

\PY{n}{startpoints} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{n}{\PYZus{}startpoints} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}

\PY{k}{for} \PY{n}{e}\PY{p}{,} \PY{n}{w} \PY{o+ow}{in} \PY{n}{edge\PYZus{}dict}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{:}
    \PY{k}{if} \PY{n}{start\PYZus{}ip} \PY{o+ow}{in} \PY{n}{e}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{:} 
        \PY{n}{startpoints}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{e}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}

\PY{k}{for} \PY{n}{sp} \PY{o+ow}{in} \PY{n}{startpoints}\PY{p}{:}
    \PY{k}{for} \PY{n}{e}\PY{p}{,} \PY{n}{w} \PY{o+ow}{in} \PY{n}{edge\PYZus{}dict}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{:}
        \PY{k}{if} \PY{n}{sp} \PY{o+ow}{in} \PY{n}{e}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{:}
            \PY{k}{if} \PY{n}{e}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{\PYZus{}startpoints}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{:}
                \PY{n}{\PYZus{}startpoints}\PY{p}{[}\PY{n}{e}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]} \PY{o}{=} \PY{n}{w}
            \PY{k}{else}\PY{p}{:}
                \PY{n}{\PYZus{}startpoints}\PY{p}{[}\PY{n}{e}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]} \PY{o}{+}\PY{o}{=} \PY{n}{w}
    
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Existen }\PY{l+s+s2}{\PYZdq{}}\PY{o}{+} \PY{n+nb}{str}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{\PYZus{}startpoints}\PY{p}{)}\PY{p}{)} \PY{o}{+} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ IPs que suceden al IP de inicio: }\PY{l+s+s2}{\PYZdq{}} \PY{o}{+} \PY{n}{start\PYZus{}ip} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{total} \PY{o}{=} \PY{l+m+mi}{0}
\PY{k}{for} \PY{n}{sp}\PY{p}{,} \PY{n}{w} \PY{o+ow}{in} \PY{n}{\PYZus{}startpoints}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{:}
    \PY{n}{total} \PY{o}{+}\PY{o}{=} \PY{n}{w}
    
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{str(total)\PYZcb{} Total pesos de edges que proceden del edge con IP inicial (}\PY{l+s+si}{\PYZob{}start\PYZus{}ip\PYZcb{}}\PY{l+s+s2}{).}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Este número es mayor al número de archivos de }\PY{l+s+si}{\PYZob{}site\PYZus{}name\PYZcb{}}\PY{l+s+s2}{ porque no todos estos edges (\PYZus{}startpoints) proceden del edge con IP inicial }\PY{l+s+si}{\PYZob{}start\PYZus{}ip\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

\PY{n}{shortest\PYZus{}paths} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{40}\PY{p}{,} \PY{l+m+mi}{120}\PY{p}{)}\PY{p}{)}
\PY{n}{j} \PY{o}{=} \PY{l+m+mi}{0}

\PY{c+c1}{\PYZsh{} Para cada endpoint se busca su camino más corto en el grafo y se grafica.}
\PY{k}{for} \PY{n}{ep}\PY{p}{,} \PY{n}{times\PYZus{}used} \PY{o+ow}{in} \PY{n}{endpoints}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{:}
    \PY{n}{j} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
    \PY{n}{sp} \PY{o}{=} \PY{n}{nx}\PY{o}{.}\PY{n}{algorithms}\PY{o}{.}\PY{n}{shortest\PYZus{}path}\PY{p}{(}\PY{n}{G}\PY{p}{,} \PY{n}{source}\PY{o}{=}\PY{n}{start\PYZus{}ip} \PY{p}{,} \PY{n}{target}\PY{o}{=}\PY{n}{ep}\PY{p}{,} \PY{n}{weight}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{weight}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{n}{shortest\PYZus{}paths}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sp}\PY{p}{)}
    \PY{n}{sp\PYZus{}G} \PY{o}{=} \PY{n}{nx}\PY{o}{.}\PY{n}{DiGraph}\PY{p}{(}\PY{p}{)}

    \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{sp}\PY{p}{)}\PY{p}{)}\PY{p}{:}
        \PY{k}{try}\PY{p}{:}
            \PY{n}{sp\PYZus{}G}\PY{o}{.}\PY{n}{add\PYZus{}edge}\PY{p}{(}\PY{n}{sp}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,} \PY{n}{sp}\PY{p}{[}\PY{n}{i}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{weight}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
        \PY{k}{except}\PY{p}{:}
            
            \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{j}\PY{p}{)}
            
            \PY{c+c1}{\PYZsh{}se dibuja el grafo.}
            \PY{n}{nx}\PY{o}{.}\PY{n}{draw}\PY{p}{(}\PY{n}{sp\PYZus{}G}\PY{p}{,} \PY{n}{with\PYZus{}labels}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
            \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Endpoint:}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZob{}ep\PYZcb{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{Path length:}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{len(sp)\PYZcb{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{Times used:}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZob{}times\PYZus{}used\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
            
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}

\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Informacion WHOIS de cada nodo del camino}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

\PY{n}{most\PYZus{}used\PYZus{}path} \PY{o}{=} \PY{n}{nx}\PY{o}{.}\PY{n}{algorithms}\PY{o}{.}\PY{n}{shortest\PYZus{}path}\PY{p}{(}\PY{n}{G}\PY{p}{,} \PY{n}{source}\PY{o}{=}\PY{n}{start\PYZus{}ip} \PY{p}{,} \PY{n}{target}\PY{o}{=}\PY{n+nb}{max}\PY{p}{(}\PY{n}{endpoints}\PY{p}{)}\PY{p}{,} \PY{n}{weight}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{weight}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{country\PYZus{}codes} \PY{o}{=} \PY{p}{[}\PY{p}{]}

\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{most\PYZus{}used\PYZus{}path}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
    \PY{n}{ip} \PY{o}{=} \PY{n}{most\PYZus{}used\PYZus{}path}\PY{p}{[}\PY{n}{i}\PY{p}{]}
    \PY{n+nb}{print}\PY{p}{(}\PY{n}{ip}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{k}{try}\PY{p}{:}
        \PY{n}{obj} \PY{o}{=} \PY{n}{IPWhois}\PY{p}{(}\PY{n}{ip}\PY{p}{)}
        \PY{n}{result} \PY{o}{=} \PY{n}{obj}\PY{o}{.}\PY{n}{lookup\PYZus{}rdap}\PY{p}{(}\PY{n}{asn\PYZus{}methods}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dns}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{whois}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{http}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}Save country codes for later plotting}
        \PY{n}{country\PYZus{}codes}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{result}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{asn\PYZus{}country\PYZus{}code}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{ASN: }\PY{l+s+si}{\PYZob{}result[\PYZsq{}asn\PYZsq{}]\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{CIDR: }\PY{l+s+si}{\PYZob{}result[\PYZsq{}asn\PYZus{}cidr\PYZsq{}]\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
              \PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{Codigo de pais: }\PY{l+s+si}{\PYZob{}result[\PYZsq{}asn\PYZus{}country\PYZus{}code\PYZsq{}]\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
              \PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{Descripcion: }\PY{l+s+si}{\PYZob{}result[\PYZsq{}asn\PYZus{}description\PYZsq{}]\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
              \PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{Registrado en: }\PY{l+s+si}{\PYZob{}result[\PYZsq{}asn\PYZus{}registry\PYZsq{}]\PYZcb{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{sep}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{k}{except}\PY{p}{:}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{INFORMACION PRIVADA}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

\PY{n}{ep} \PY{o}{=} \PY{n}{most\PYZus{}used\PYZus{}path}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
\PY{n}{ep\PYZus{}ip} \PY{o}{=} \PY{n}{ep}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{ep\PYZus{}ip}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{k}{try}\PY{p}{:}
    \PY{n}{obj} \PY{o}{=} \PY{n}{IPWhois}\PY{p}{(}\PY{n}{ep\PYZus{}ip}\PY{p}{)}
    \PY{n}{result} \PY{o}{=} \PY{n}{obj}\PY{o}{.}\PY{n}{lookup\PYZus{}rdap}\PY{p}{(}\PY{n}{asn\PYZus{}methods}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dns}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{whois}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{http}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{ASN: }\PY{l+s+si}{\PYZob{}result[\PYZsq{}asn\PYZsq{}]\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{CIDR: }\PY{l+s+si}{\PYZob{}result[\PYZsq{}asn\PYZus{}cidr\PYZsq{}]\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
              \PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{Codigo de pais: }\PY{l+s+si}{\PYZob{}result[\PYZsq{}asn\PYZus{}country\PYZus{}code\PYZsq{}]\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
              \PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{Descripcion: }\PY{l+s+si}{\PYZob{}result[\PYZsq{}asn\PYZus{}description\PYZsq{}]\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
              \PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{Registrado en: }\PY{l+s+si}{\PYZob{}result[\PYZsq{}asn\PYZus{}registry\PYZsq{}]\PYZcb{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{sep}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{k}{except}\PY{p}{:}
    \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{INFORMACION PRIVADA}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

\PY{n}{most\PYZus{}used\PYZus{}path} \PY{o}{=} \PY{n}{nx}\PY{o}{.}\PY{n}{algorithms}\PY{o}{.}\PY{n}{shortest\PYZus{}path}\PY{p}{(}\PY{n}{G}\PY{p}{,} \PY{n}{source}\PY{o}{=}\PY{n}{start\PYZus{}ip} \PY{p}{,} \PY{n}{target}\PY{o}{=}\PY{n+nb}{max}\PY{p}{(}\PY{n}{endpoints}\PY{p}{)}\PY{p}{,} \PY{n}{weight}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{weight}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{coordinates} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{n}{just\PYZus{}countries} \PY{o}{=} \PY{p}{[}\PY{p}{]}


\PY{k}{for} \PY{n}{ip} \PY{o+ow}{in} \PY{n}{most\PYZus{}used\PYZus{}path}\PY{p}{:}
    \PY{n}{ip} \PY{o}{=} \PY{n}{ip}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
    \PY{n}{r} \PY{o}{=} \PY{n}{dbs}\PY{o}{.}\PY{n}{HostIP}\PY{o}{.}\PY{n}{get}\PY{p}{(}\PY{n}{ip}\PY{p}{)}
    \PY{k}{if} \PY{o+ow}{not} \PY{n}{r}\PY{o}{.}\PY{n}{country} \PY{o+ow}{and} \PY{o+ow}{not} \PY{n}{r}\PY{o}{.}\PY{n}{region} \PY{o+ow}{and} \PY{o+ow}{not} \PY{n}{r}\PY{o}{.}\PY{n}{city} \PY{o+ow}{and} \PY{o+ow}{not} \PY{n}{r}\PY{o}{.}\PY{n}{longitude} \PY{o+ow}{and} \PY{o+ow}{not} \PY{n}{r}\PY{o}{.}\PY{n}{latitude}\PY{p}{:}
        \PY{n+nb}{print}\PY{p}{(}\PY{n}{ip}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Private}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{sep}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    \PY{k}{else}\PY{p}{:}
        \PY{k}{if} \PY{n}{r}\PY{o}{.}\PY{n}{longitude} \PY{o+ow}{and} \PY{n}{r}\PY{o}{.}\PY{n}{latitude}\PY{p}{:} \PY{n}{coordinates}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{(}\PY{n}{r}\PY{o}{.}\PY{n}{longitude}\PY{p}{,} \PY{n}{r}\PY{o}{.}\PY{n}{latitude}\PY{p}{)}\PY{p}{)}
        \PY{k}{elif} \PY{n}{r}\PY{o}{.}\PY{n}{country}\PY{p}{:} \PY{n}{just\PYZus{}countries}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{r}\PY{o}{.}\PY{n}{country}\PY{p}{)}
            
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+si}{\PYZob{}ip\PYZcb{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{Ctry:}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{r.country if r.country else }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{\PYZcb{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{City:}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{r.city if r.city else }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{\PYZcb{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{Regn:}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{r.region if r.region else }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{\PYZcb{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{Long:}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{r.longitude if r.longitude else }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{\PYZcb{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{Lat:}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{\PYZob{}}\PY{l+s+s2}{r.latitude if r.latitude else }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{\PYZcb{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

\PY{n}{just\PYZus{}countries}\PY{o}{.}\PY{n}{extend}\PY{p}{(}\PY{n+nb}{set}\PY{p}{(}\PY{n}{country\PYZus{}codes}\PY{p}{)}\PY{p}{)}              

\PY{c+c1}{\PYZsh{} Chequea cuantos edges conectan al IP de Telconet S.A.}
\PY{n}{ips} \PY{o}{=} \PY{p}{[}\PY{p}{]}

\PY{k}{for} \PY{n}{edge}\PY{p}{,} \PY{n}{w} \PY{o+ow}{in} \PY{n}{edge\PYZus{}dict}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{:}
    \PY{k}{if} \PY{n}{edge}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{181.198.130.1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
        \PY{n}{ips}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{(}\PY{n}{edge}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{w}\PY{p}{)}\PY{p}{)}

\PY{n+nb}{print}\PY{p}{(}\PY{l+s+sa}{f}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Al menos }\PY{l+s+si}{\PYZob{}ips[0][1]\PYZcb{}}\PY{l+s+s2}{ archivos incluyen una salida desde el IP de Telconet S.A.: 181.198.130.1}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

\PY{n+nb}{map} \PY{o}{=} \PY{n}{gpd}\PY{o}{.}\PY{n}{read\PYZus{}file}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{TM\PYZus{}WORLD\PYZus{}BORDERS\PYZhy{}0.3.shp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{geometry} \PY{o}{=} \PY{p}{[}\PY{n}{Point}\PY{p}{(}\PY{n}{xy}\PY{p}{)} \PY{k}{for} \PY{n}{xy} \PY{o+ow}{in} \PY{n}{coordinates}\PY{p}{]}

\PY{n}{geo\PYZus{}df\PYZus{}exact} \PY{o}{=} \PY{n}{gpd}\PY{o}{.}\PY{n}{GeoDataFrame}\PY{p}{(}\PY{n}{geometry}\PY{o}{=} \PY{n}{geometry}\PY{p}{)}


\PY{n}{country\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{countries\PYZus{}codes\PYZus{}and\PYZus{}coordinates.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}

\PY{n}{country\PYZus{}df} \PY{o}{=} \PY{n}{country\PYZus{}df}\PY{o}{.}\PY{n}{set\PYZus{}index}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{alpha\PYZhy{}2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n}{\PYZus{}df} \PY{o}{=} \PY{n}{country\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{just\PYZus{}countries}\PY{p}{]}
\PY{n}{just\PYZus{}c\PYZus{}coords} \PY{o}{=} \PY{p}{[}\PY{n}{xy} \PY{k}{for} \PY{n}{xy} \PY{o+ow}{in} \PY{n+nb}{zip}\PY{p}{(}\PY{p}{[}\PY{n}{x}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{longitude}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{n}{x}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{latitude}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{]}


\PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{)}\PY{p}{)}

\PY{n+nb}{map}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{,} \PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{green}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{;}
\PY{n}{geo\PYZus{}df\PYZus{}exact}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{red}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{;}

\PY{n}{geometry} \PY{o}{=} \PY{p}{[}\PY{n}{Point}\PY{p}{(}\PY{n}{xy}\PY{p}{)} \PY{k}{for} \PY{n}{xy} \PY{o+ow}{in} \PY{n}{just\PYZus{}c\PYZus{}coords}\PY{p}{]}
\PY{n}{geo\PYZus{}df\PYZus{}just\PYZus{}c} \PY{o}{=} \PY{n}{gpd}\PY{o}{.}\PY{n}{GeoDataFrame}\PY{p}{(}\PY{n}{geometry}\PY{o}{=} \PY{n}{geometry}\PY{p}{)}
\PY{n}{geo\PYZus{}df\PYZus{}just\PYZus{}c}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{;}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Nodes of graph:
213
Edges of graph:
314
Filtered IPs: 64
\{'172.21.18.126': \{'weight': 0\}, '181.198.150.1': \{'weight': 0\}, '172.20.10.1':
\{'weight': 0\}, '192.168.86.1': \{'weight': 0\}, '200.63.218.97': \{'weight': 0\},
'100.98.8.1': \{'weight': 0\}, '181.198.130.1': \{'weight': 0\}, '72.14.234.8':
\{'weight': 0\}, '104.27.181.97': \{'weight': 0\}, '209.85.143.102': \{'weight': 0\},
'186.4.244.1': \{'weight': 0\}, '100.97.32.1': \{'weight': 0\}, '157.100.244.1':
\{'weight': 0\}, '10.0.0.1': \{'weight': 0\}, '186.46.4.225': \{'weight': 0\},
'186.101.152.1': \{'weight': 0\}, '186.4.145.1': \{'weight': 0\}, '100.96.233.1':
\{'weight': 0\}, '200.63.218.177': \{'weight': 0\}, '100.98.68.1': \{'weight': 0\},
'186.101.137.1': \{'weight': 0\}, '181.198.191.129': \{'weight': 0\},
'186.46.4.174': \{'weight': 0\}, '186.46.4.226': \{'weight': 0\}\}
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Análisis inicial de Redes usando protocolo ICMP_files/Análisis inicial de Redes usando protocolo ICMP_24_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
Existen 6 IPs destino para Facebook

El endpoint más usado es :
 ('31.13.67.35/Facebook', 33)
Existen 24 IPs que suceden al IP de inicio: 127.0.0.1

72 Total pesos de edges que proceden del edge con IP inicial (127.0.0.1).

Este número es mayor al número de archivos de Facebook porque no todos estos
edges (\_startpoints) proceden del edge con IP inicial 127.0.0.1
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
C:\textbackslash{}ProgramData\textbackslash{}Anaconda3\textbackslash{}lib\textbackslash{}site-
packages\textbackslash{}matplotlib\textbackslash{}backends\textbackslash{}backend\_agg.py:211: RuntimeWarning: Glyph 9 missing
from current font.
  font.set\_text(s, 0.0, flags=flags)
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Análisis inicial de Redes usando protocolo ICMP_files/Análisis inicial de Redes usando protocolo ICMP_24_4.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
Informacion WHOIS de cada nodo del camino

127.0.0.1

        INFORMACION PRIVADA

181.198.130.1

        ASN: 27947
        CIDR: 181.198.128.0/19
        Codigo de pais: EC
        Descripcion: Telconet S.A, EC
        Registrado en: lacnic

10.201.232.57

        INFORMACION PRIVADA

10.201.232.53

        INFORMACION PRIVADA

10.201.232.38

        INFORMACION PRIVADA

10.201.232.42

        INFORMACION PRIVADA

10.201.232.61

        INFORMACION PRIVADA

10.201.232.5

        INFORMACION PRIVADA

157.240.69.54

        ASN: 32934
        CIDR: 157.240.0.0/17
        Codigo de pais: US
        Descripcion: FACEBOOK, US
        Registrado en: arin

129.134.32.127

        ASN: 32934
        CIDR: 129.134.0.0/17
        Codigo de pais: US
        Descripcion: FACEBOOK, US
        Registrado en: arin

173.252.67.95

        ASN: 32934
        CIDR: 173.252.64.0/19
        Codigo de pais: US
        Descripcion: FACEBOOK, US
        Registrado en: arin

31.13.67.35

        ASN: 32934
        CIDR: 31.13.67.0/24
        Codigo de pais: IE
        Descripcion: FACEBOOK, US
        Registrado en: ripencc

127.0.0.1       Private
181.198.130.1   Private
10.201.232.57   Private
10.201.232.53   Private
10.201.232.38   Private
10.201.232.42   Private
10.201.232.61   Private
10.201.232.5    Private

157.240.69.54
Ctry:   US
City:
Regn:
Long:
Lat:


129.134.32.127
Ctry:   US
City:
Regn:
Long:
Lat:

173.252.67.95   Private

31.13.67.35
Ctry:   ID
City:   Jakarta
Regn:
Long:   106.8
Lat:    -6.26667

Al menos 6 archivos incluyen una salida desde el IP de Telconet S.A.:
181.198.130.1
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{Análisis inicial de Redes usando protocolo ICMP_files/Análisis inicial de Redes usando protocolo ICMP_24_6.png}
    \end{center}
    { \hspace*{\fill} \\}
    

    % Add a bibliography block to the postdoc
    
    
    
\end{document}
